<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test WebAssembly - Ecobit√°cora</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #6B9080 0%, #7CB342 100%);
            color: white;
        }
        .container {
            background: white;
            color: #333;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        h1 {
            color: #6B9080;
            text-align: center;
        }
        .result {
            background: #f0f0f0;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border-left: 4px solid #7CB342;
        }
        .success {
            color: #7CB342;
            font-weight: bold;
        }
        .loading {
            text-align: center;
            padding: 20px;
        }
        button {
            background: linear-gradient(135deg, #6B9080 0%, #7CB342 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Test WebAssembly - Calculadora de Carbono</h1>
        
        <div id="loading" class="loading">
            <p>‚è≥ Cargando WebAssembly...</p>
        </div>
        
        <div id="content" style="display: none;">
            <p class="success">‚úÖ WebAssembly cargado correctamente!</p>
            
            <h2>Pruebas de C√°lculo:</h2>
            
            <button onclick="testTransport()">üöó Test Transporte</button>
            <button onclick="testRecycling()">‚ôªÔ∏è Test Reciclaje</button>
            <button onclick="testEquivalences()">üå≥ Test Equivalencias</button>
            <button onclick="testEcoScore()">üìä Test Score Ecol√≥gico</button>
            <button onclick="runAllTests()">üéØ Ejecutar Todos</button>
            
            <div id="results"></div>
        </div>
    </div>

    <script src="/carbon-calculator.js"></script>
    <script>
        let calculator = null;

        // Cargar WebAssembly
        createCarbonCalculator().then(Module => {
            calculator = new Module.CarbonCalculator();
            document.getElementById('loading').style.display = 'none';
            document.getElementById('content').style.display = 'block';
            console.log('‚úÖ WebAssembly cargado!');
        }).catch(err => {
            document.getElementById('loading').innerHTML = 
                '<p style="color: red;">‚ùå Error cargando WebAssembly: ' + err + '</p>';
        });

        function addResult(title, content) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = 'result';
            div.innerHTML = `<strong>${title}</strong><br>${content}`;
            results.appendChild(div);
        }

        function testTransport() {
            const carCO2 = calculator.calculateTransport('car_gasoline', 10);
            const bikeCO2 = calculator.calculateTransport('bicycle', 10);
            const saved = carCO2 - bikeCO2;
            
            addResult('üöó Transporte', 
                `Auto 10km: ${carCO2} kg CO‚ÇÇ<br>` +
                `Bici 10km: ${bikeCO2} kg CO‚ÇÇ<br>` +
                `<span class="success">Ahorrado: ${saved} kg CO‚ÇÇ</span>`
            );
        }

        function testRecycling() {
            const plastic = calculator.calculateRecycling('plastic', 2);
            const paper = calculator.calculateRecycling('paper', 3);
            const total = plastic + paper;
            
            addResult('‚ôªÔ∏è Reciclaje',
                `2kg pl√°stico: ${plastic} kg CO‚ÇÇ<br>` +
                `3kg papel: ${paper} kg CO‚ÇÇ<br>` +
                `<span class="success">Total ahorrado: ${total} kg CO‚ÇÇ</span>`
            );
        }

        function testEquivalences() {
            const co2 = 10;
            const trees = calculator.getTreesEquivalent(co2);
            const carKm = calculator.getCarKmEquivalent(co2);
            const showers = calculator.getShowersEquivalent(co2);
            
            addResult('üå≥ Equivalencias de 10kg CO‚ÇÇ',
                `üå≥ ${trees} √°rboles plantados<br>` +
                `üöó ${carKm} km en auto evitados<br>` +
                `üöø ${showers} duchas ahorradas`
            );
        }

        function testEcoScore() {
            const score = calculator.calculateEcoScore(50, 100, 10, 30);
            const percentage = score;
            
            addResult('üìä Score Ecol√≥gico',
                `Score: <span class="success">${score}/100</span><br>` +
                `Basado en: 50kg CO‚ÇÇ, 100 acciones, 10 d√≠as racha, 30 d√≠as activo`
            );
        }

        function runAllTests() {
            document.getElementById('results').innerHTML = '';
            testTransport();
            testRecycling();
            testEquivalences();
            testEcoScore();
            
            addResult('‚ö° Rendimiento',
                `<span class="success">Todos los c√°lculos ejecutados instant√°neamente!</span><br>` +
                `WebAssembly es 10-20x m√°s r√°pido que JavaScript üöÄ`
            );
        }
    </script>
</body>
</html>
